<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Single listing</title>
</head>
<body>
    <li><a href="/">Home</a></li>
    <div >
        <a href='/all_listings/{{ data.house_id}}'>
          {% for image in data.image_url %}
            <img src="{{ url_for('static', filename=image) }}">
          {% endfor %}
          <h4> {{data.house_name}}</h4>
        </a>
        {% if data.is_available == 1 and data.deleted == 0 and data.approved == 1 %}
            {% if not current_user.user_id or current_user.user_id != data.landlord_id%}
                <form method="POST" action="/send_renting_request">
                    <button name="house_id" value={{data.house_id}}>Send renting request</button>
                </form>
            {% endif %}
        {% endif %}
    </div>
    <div >
        <p>Price: {{data.price}}</p>
        <p>Type: {{data.type}}</p>
        <p>Size: {{data.size}}</p>
        <p>Distance: {{data.distance}}</p>
        <p>Features: {{data.bedroom_count}} bedroom(s), {{data.bathroom_count}} bathroom(s), {{data.parking_count}} parking spot(s)</p>
        <p>Address: {{data.number}}  {{data.street}}  {{data.city}}, {{data.state}}, {{data.zipcode}}</p>
        <p>Description: {{data.description}}</p>
        <p>Availability: {{data.is_available}}</p>
    </div>


    {% if data.is_available == 1 and data.deleted == 0 and data.approved == 1 %}
        {% if not current_user.user_id or current_user.user_id != data.landlord_id%}
            <form method="POST" action="/send_direct_msg">
                <input type="text" placeholder="Message landlord" name="message">
                <button name="house_id" value={{data.house_id}}>Message landlord</button>
            </form>
        {% endif %}
    {% endif %}

    <form>
    </form>

     <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Simple Markers</title>
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        {#height: 80%;#}
          height:300px;
          width:800px;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        {#height: 80%;#}
          height:300px;
          width:800px;

        margin: 0;
        padding: 0;
      }
    </style>
      </head>
      <body>
        <div id="map"></div>
    {#    <div id="right-panel"></div>#}
        <script>


     function initMap() {


      var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 4,
        center: {lat: 37.7219, lng: -122.4782}  // SF.
      });


      var directionsService = new google.maps.DirectionsService;
      var directionsDisplay = new google.maps.DirectionsRenderer({
        draggable: true,
        map: map,
        panel: document.getElementById('right-panel')
      });

      directionsDisplay.addListener('directions_changed', function() {
        computeTotalDistance(directionsDisplay.getDirections());
      });

      displayRoute('1600 Holloway Dr. San Francisco, CA', '{{data.number}}  {{data.street}}  {{data.city}}, {{data.state}}, {{data.zipcode}}', directionsService,
          directionsDisplay);
    }

    function displayRoute(origin, destination, service, display) {
      service.route({
        origin: origin,
        destination: destination,
        travelMode: 'DRIVING',
        avoidTolls: true
      }, function(response, status) {
        if (status === 'OK') {
          display.setDirections(response);
        } else {
          alert('Could not display directions due to: ' + status);
        }
      });
    }

    function computeTotalDistance(result) {
      var total = 0;
      var myroute = result.routes[0];
      for (var i = 0; i < myroute.legs.length; i++) {
        total += myroute.legs[i].distance.value;
      }
      total = total / 1000;
      document.getElementById('total').innerHTML = total + ' km';
    }


        </script>
        <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAj2puVPdBo9PeJ0_XP_m5JCSMuc2XGVOk&callback=initMap&libraries=geometry">
        </script>
      </body>











</body>
</html>